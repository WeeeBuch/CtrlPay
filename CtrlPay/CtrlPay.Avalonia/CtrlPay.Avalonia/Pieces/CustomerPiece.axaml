<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewmodels="using:CtrlPay.Avalonia.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="500"
             Background="{DynamicResource Color.Background}"
             x:Class="CtrlPay.Avalonia.CustomerPiece"
             x:DataType="viewmodels:CustomerPieceViewModel">
    <Border Classes="customerCard">
    <Expander Classes="customerExpander" IsExpanded="{Binding IsExpanded}">
        <Expander.Header>
            <Grid ColumnDefinitions="Auto, Auto, *, Auto">
                <Border Grid.Column="0" Width="4" Height="18" Background="{DynamicResource Brush.Accent}" CornerRadius="8"/>

                <TextBlock Grid.Column="1" 
                           Text="{Binding Model.Id, StringFormat='#{0}'}" 
                           Classes="label" Margin="10,0,10,0"/>

                <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Left">
                    <TextBlock Text="{Binding DisplayName}" 
                               FontWeight="SemiBold" FontSize="15"/>
                </StackPanel>

                <StackPanel Grid.Column="3" Orientation="Horizontal" Spacing="5">
                    <Button Content="{DynamicResource Customers.Button.Edit}" Command="{Binding StartEditCommand}" IsVisible="{Binding !Editing}"/>
                    <Button Content="{DynamicResource Customers.Button.Delete}" Command="{Binding DeleteEditCommand}" IsVisible="{Binding Editing}"/>
                    <Button Content="{DynamicResource Customers.Button.Cancel}" Command="{Binding CancelEditCommand}" IsVisible="{Binding Editing}"/>
                    <Button Content="{DynamicResource Customers.Button.Save}" Command="{Binding EndEditCommand}" IsVisible="{Binding Editing}"/>
                </StackPanel>
            </Grid>
        </Expander.Header>

        <StackPanel Margin="16,0,16,16" Spacing="10">
            <Rectangle Height="1" Fill="{DynamicResource Brush.Border}" Margin="0,0,0,8"/>

            <StackPanel IsVisible="{Binding Editing}" Margin="0,0,0,10">
                <ToggleSwitch IsChecked="{Binding Model.Physical}" 
                  OnContent="{DynamicResource Customers.Toggle.Physical}" 
                  OffContent="{DynamicResource Customers.Toggle.Company}"
                  Command="{Binding TogglePhCommand}"/> 
            </StackPanel>

            <StackPanel Spacing="8" IsVisible="{Binding IsCompany}">
                <Grid ColumnDefinitions="100, *">
                    <TextBlock Grid.Column="0" Text="{DynamicResource Customers.Label.Company}" Classes="label"/>
                    <Panel Grid.Column="1">
                        <TextBlock Text="{Binding Model.Company}" IsVisible="{Binding !Editing}" Classes="valueBold"/>
                        <TextBox Text="{Binding Model.Company, UpdateSourceTrigger=PropertyChanged}" IsVisible="{Binding Editing}"/>
                    </Panel>
                </Grid>
            </StackPanel>

            <StackPanel Spacing="8" IsVisible="{Binding IsPhysical}">
                <Grid ColumnDefinitions="100, *">
                    <TextBlock Grid.Column="0" Text="{DynamicResource Customers.Label.Title}" Classes="label"/>
                    <Panel Grid.Column="1">
                        <TextBlock Text="{Binding Model.Title}" IsVisible="{Binding !Editing}"/>
                        <TextBox Text="{Binding Model.Title}" IsVisible="{Binding Editing}"/>
                    </Panel>
                </Grid>
                
                <Grid ColumnDefinitions="100, *">
                    <TextBlock Grid.Column="0" Text="{DynamicResource Customers.Label.FirstName}" Classes="label"/>
                    <Panel Grid.Column="1">
                        <TextBlock Text="{Binding Model.FirstName, UpdateSourceTrigger=PropertyChanged}" IsVisible="{Binding !Editing}"/>
                        <TextBox Text="{Binding Model.FirstName}" IsVisible="{Binding Editing}"/>
                    </Panel>
                </Grid>

                <Grid ColumnDefinitions="100, *">
                    <TextBlock Grid.Column="0" Text="{DynamicResource Customers.Label.LastName}" Classes="label"/>
                    <Panel Grid.Column="1">
                        <TextBlock Text="{Binding Model.LastName}" IsVisible="{Binding !Editing}"/>
                        <TextBox Text="{Binding Model.LastName}" IsVisible="{Binding Editing}"/>
                    </Panel>
                </Grid>
            </StackPanel>

            <Separator Height="1" Background="{DynamicResource Brush.Border}" Margin="0,5"/>

            <Grid ColumnDefinitions="100, *, 100, *" RowDefinitions="Auto, Auto">
                <TextBlock Grid.Row="0" Grid.Column="0" Text="{DynamicResource Customers.Label.Phone}" Classes="label"/>
                <Panel Grid.Row="0" Grid.Column="1">
                    <TextBlock Text="{Binding Model.Phone}" IsVisible="{Binding !Editing}"/>
                    <TextBox Text="{Binding Model.Phone}" IsVisible="{Binding Editing}"/>
                </Panel>

                <TextBlock Grid.Row="0" Grid.Column="2" Text="{DynamicResource Customers.Label.Email}" Classes="label" Margin="10,0,0,0"/>
                <Panel Grid.Row="0" Grid.Column="3">
                    <TextBlock Text="{Binding Model.Email}" IsVisible="{Binding !Editing}"/>
                    <TextBox Text="{Binding Model.Email}" IsVisible="{Binding Editing}"/>
                </Panel>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="{DynamicResource Customers.Label.Address}" Classes="label" Margin="0,10,0,0"/>
                <StackPanel Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3" Margin="0,10,0,0">
                     <Panel>
                        <TextBlock Text="{Binding Model.Address}" IsVisible="{Binding !Editing}"/>
                        <TextBox Text="{Binding Model.Address}" IsVisible="{Binding Editing}" Watermark="Ulice a č.p."/>
                    </Panel>
                    <Grid ColumnDefinitions="*, 80" Margin="0,5,0,0">
                        <Panel Grid.Column="0">
                            <TextBlock Text="{Binding Model.City}" IsVisible="{Binding !Editing}"/>
                            <TextBox Text="{Binding Model.City}" IsVisible="{Binding Editing}" Watermark="Město"/>
                        </Panel>
                        <Panel Grid.Column="1" Margin="5,0,0,0">
                            <TextBlock Text="{Binding Model.PostalCode}" IsVisible="{Binding !Editing}"/>
                            <TextBox Text="{Binding Model.PostalCode}" IsVisible="{Binding Editing}" Watermark="PSČ"/>
                        </Panel>
                    </Grid>
                </StackPanel>
            </Grid>
        </StackPanel>
    </Expander>
</Border>
</UserControl>
