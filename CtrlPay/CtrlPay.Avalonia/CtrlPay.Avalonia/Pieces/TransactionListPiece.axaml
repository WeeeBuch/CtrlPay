<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:CtrlPay.Avalonia.ViewModels"
             mc:Ignorable="d" d:DesignWidth="500" d:DesignHeight="450"
             x:Class="CtrlPay.Avalonia.TransactionListPiece"
             x:DataType="vm:TransactionListPieceModel">
  
    <Border Background="{DynamicResource Color.Background}" 
            BorderBrush="{DynamicResource Color.Border}" 
            BorderThickness="2" 
            CornerRadius="15" 
            Padding="15">
    
        <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                      VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding Transactions}">
                <ItemsControl.DataTemplates>
                    
                    <DataTemplate DataType="vm:SeparatorItemViewModel">
                        <Grid ColumnDefinitions="*,Auto,*" Margin="0,15">
                            <Separator Grid.Column="0" Foreground="#33FFFFFF"/>
                            <TextBlock Grid.Column="1" Text="{Binding Label}" 
                                       Margin="10,0" FontSize="11" Foreground="#66FFFFFF"/>
                            <Separator Grid.Column="2" Foreground="#33FFFFFF"/>
                        </Grid>
                    </DataTemplate>

                    <DataTemplate DataType="vm:TransactionItemViewModel">
    <Border Background="{DynamicResource Brush.Surface}" 
            CornerRadius="12" 
            Margin="0,4" 
            Padding="16,12"
            BorderBrush="{DynamicResource Brush.Border}"
            BorderThickness="1">
        
        <Border.Styles>
            <Style Selector="Ellipse.indicator">
                <Setter Property="Fill" Value="{DynamicResource Brush.Text.Disabled}"/>
            </Style>
            <Style Selector="Ellipse.indicator[Tag=Completed]">
                <Setter Property="Fill" Value="{DynamicResource Brush.Success}"/>
            </Style>
            <Style Selector="Ellipse.indicator[Tag=Pending]">
                <Setter Property="Fill" Value="{DynamicResource Brush.Warning}"/>
            </Style>
            <Style Selector="Ellipse.indicator[Tag=Failed]">
                <Setter Property="Fill" Value="{DynamicResource Brush.Error}"/>
            </Style>

            <Style Selector="TextBlock.statusText">
                <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Secondary}"/>
            </Style>
            <Style Selector="TextBlock.statusText[Tag=Completed]">
                <Setter Property="Foreground" Value="{DynamicResource Brush.Success}"/>
            </Style>
            <Style Selector="TextBlock.statusText[Tag=Pending]">
                <Setter Property="Foreground" Value="{DynamicResource Brush.Warning}"/>
            </Style>
            <Style Selector="TextBlock.statusText[Tag=Failed]">
                <Setter Property="Foreground" Value="{DynamicResource Brush.Error}"/>
            </Style>
        </Border.Styles>

        <Grid ColumnDefinitions="Auto, *, Auto">
            
            <Ellipse Grid.Column="0" 
                     Classes="indicator" 
                     Tag="{Binding Status}"
                     Width="8" Height="8" 
                     Margin="0,0,16,0"
                     VerticalAlignment="Center"/>
            
            <StackPanel Grid.Column="1" Spacing="2">
                <TextBlock Text="{Binding Title}" 
                           Foreground="{DynamicResource Brush.Text.Primary}"
                           FontSize="14" 
                           FontWeight="Medium"/>
                
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="{Binding Date, StringFormat=\{0:dd.MM.yyyy HH:mm\}}" 
                               FontSize="11" 
                               Foreground="{DynamicResource Brush.Text.Disabled}"/>
                    
                    <TextBlock Text="•" FontSize="11" Foreground="{DynamicResource Brush.Text.Disabled}"/>
                    
                    <TextBlock Text="{Binding Status}" 
                               Tag="{Binding Status}"
                               FontSize="11" 
                               FontWeight="SemiBold"
                               Classes="statusText"/>
                </StackPanel>
            </StackPanel>

            <StackPanel Grid.Column="2" VerticalAlignment="Center">
                <TextBlock Text="{Binding Amount, StringFormat=\{0:N8\}}" 
                           Foreground="{DynamicResource Brush.Text.Primary}"
                           FontWeight="Bold" 
                           FontSize="15"/>
                <TextBlock Text="XMR" 
                           Foreground="{DynamicResource Brush.Text.Disabled}" 
                           FontSize="10" 
                           HorizontalAlignment="Right"/>
            </StackPanel>
        </Grid>
    </Border>
</DataTemplate>
                </ItemsControl.DataTemplates>
            </ItemsControl>
        </ScrollViewer>
    </Border>
</UserControl>
